<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Manager - Panel de Control</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- favicon pending -->
    <link rel="stylesheet" href="/app/css/admin.css">
    <link rel="stylesheet" href="/app/css/reviews.css">
</head>
<body class="hs-no-sidebar">

    <div id="login-screen">
        <div class="login-card">
            <h2 class="mb-4"><i class="fa-solid fa-hotel"></i> HotelSys</h2>
            <h5 class="text-muted mb-4">Iniciar Sesión</h5>
            <input type="text" id="login-user" class="form-control mb-3" placeholder="Usuario (ej: admin)">
            <input type="password" id="login-pass" class="form-control mb-3" placeholder="Contraseña">
            <button class="btn btn-primary w-100" onclick="iniciarSesion()">Entrar</button>
            <div class="mt-3 text-muted small">
                <strong>Usuarios de prueba:</strong><br>
                admin / camilo (Gerente) / maria (Aseo) / invitado (Huésped)<br>
                Contraseña para todos: <strong>1234</strong>
            </div>
        </div>
    </div>

    <div id="app-interface" style="display: none;">
        
        <div class="sidebar">
            <h3 class="text-center mb-4"><i class="fa-solid fa-hotel"></i></h3>
            <div class="px-3 mb-3 text-center">
                <div class="badge bg-light text-dark w-100 py-2">
                    <i class="fa-solid fa-user-circle"></i> <span id="user-display">Usuario</span><br>
                    <small id="role-display" class="text-primary fw-bold">ROL</small>
                </div>
            </div>
            <!-- Panel link removed (redundant) -->
            <a id="btn-historial" href="#" class="d-none hs-side-link"><i class="fa-solid fa-clock-rotate-left me-2"></i> Mis Reservas</a>
            <a href="#" onclick="cerrarSesion(true)" class="hs-side-link hs-side-link-logout mt-auto"><i class="fa-solid fa-right-from-bracket me-2"></i> Salir</a>
        </div>

        <div class="main-content">
            <div class="topbar">
                <div>
                    <h2 class="m-0">Panel de Control</h2>
                    <div class="subtext">Admin ve todas las habitaciones • Filtra por estado o busca por número</div>
                </div>

                <div class="topbar-actions">
                    <div class="search-wrap">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <input id="room-search" class="search-input" placeholder="Buscar habitación (ej: 101)" />
                    </div>

                    <button id="btn-gestionar" class="btn btn-outline-light" onclick="abrirPanelGestion()">
                        <i class="fa-solid fa-gear"></i> Gestionar
                    </button>
                    <button id="btn-nueva-reserva" class="btn btn-success" onclick="abrirFormularioReserva()">
                        <i class="fa-solid fa-plus"></i> Nueva Reserva
                    </button>

                    <!-- Airbnb-like profile menu (since sidebar is hidden) -->
                    <div class="hs-profile" id="hs-profile">
                      <button class="hs-profile-btn" id="hs-profile-btn" type="button" aria-label="Menú de perfil">
                        <span class="hs-avatar" id="hs-avatar">U</span>
                        <span class="hs-burger" aria-hidden="true">
                          <i class="fa-solid fa-bars"></i>
                        </span>
                      </button>

                      <div class="hs-profile-menu" id="hs-profile-menu" style="display:none">
                        <div class="hs-profile-head">
                          <div class="hs-profile-name" id="hs-profile-name">Usuario</div>
                          <div class="hs-profile-role" id="hs-profile-role">ROL</div>
                          <div class="hs-profile-wallet" id="hs-profile-wallet" style="display:none"></div>
                        </div>
                        <div class="hs-profile-items">
                          <button class="hs-menu-item" id="hs-menu-manage" type="button">
                            <i class="fa-solid fa-gear"></i>
                            <span>Gestionar</span>
                          </button>
                          <button class="hs-menu-item" id="hs-menu-history" type="button" style="display:none">
                            <i class="fa-solid fa-clock-rotate-left"></i>
                            <span>Mis reservas</span>
                          </button>
                          <button class="hs-menu-item" id="hs-menu-guest-panel" type="button">
                            <i class="fa-solid fa-wand-magic-sparkles"></i>
                            <span>Panel Huésped (IA)</span>
                          </button>
                          <button class="hs-menu-item" id="hs-menu-link-wallet" type="button" style="display:none">
                            <i class="fa-brands fa-ethereum"></i>
                            <span>Vincular wallet</span>
                          </button>
                          <button class="hs-menu-item hs-menu-danger" id="hs-menu-logout" type="button">
                            <i class="fa-solid fa-right-from-bracket"></i>
                            <span>Salir</span>
                          </button>
                        </div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="filters">
                <button class="chip active" data-filter="all">Todas</button>
                <button class="chip" data-filter="disponible">Disponibles</button>
                <button class="chip d-none" id="chip-mis-reservas" data-filter="mis-reservas">Mis Reservas</button>
                <button class="chip" data-filter="ocupada" id="chip-ocupada">Ocupadas</button>
                <button class="chip" data-filter="limpieza" id="chip-limpieza">Limpieza</button>

                <div class="ms-auto stats" id="room-stats">Cargando…</div>
            </div>

            <div class="row g-4" id="rooms-container"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <script src="https://cdn.jsdelivr.net/npm/ethers@6.16.0/dist/ethers.umd.min.js"></script>

    <script src="/app/js/core/namespace.js"></script>
    <script src="/app/js/utils/formatters.js"></script>
    <script src="/app/js/core/apiClient.js"></script>
    <script src="/app/js/core/clients.js"></script>
    <script src="/app/js/core/session.js"></script>
    <script src="/app/js/core/historyStore.js"></script>
    <script src="/app/js/web3/web3Client.js"></script>
    <script src="/app/js/web3/contractSelector.js"></script>
    <script src="/app/js/web3/paymentFacade.js"></script>
    <script src="/app/js/ui/releaseModal.js"></script>
    <script src="/app/js/ui/reservaModal.js"></script>
    <script src="/app/js/ui/huespedHistoryModal.js"></script>
    <script src="/app/js/ui/habitacionManageModal.js"></script>
    <script src="/app/js/ui/chatbotWidget.js"></script>
    <script src="/app/js/ui/reviewModal.js"></script>

    <!-- Cache-bust to avoid stale JS in browsers -->
    <script src="/app/js/admin.js?v=20260210-2120"></script>
    <!-- ui cache bust via admin.js param. -->
<!-- css cache bust not needed; served fresh in dev. If caching occurs, hard refresh. -->
</body>
</html>



